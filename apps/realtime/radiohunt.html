<html>

<head>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script src="https://www.chartjs.org/dist/2.8.0/Chart.min.js"></script>


  <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/dipankar08/SimpleStyle/simplestyle.css" />
  <script src="https://cdn.jsdelivr.net/gh/dipankar08/SimpleStyle/simplestore_client.js"></script>


  <link rel="stylesheet" type="text/css" href="mystyle.css" />
  <script src="simplestore_client.js"></script>
  <script>
    function showTabs(tab) {
      $('.tab_content > div').addClass('hide');
      $('.' + tab).removeClass('hide');
      switch (tab) {
        case 'launch':
          showLaunch();
          break;
        case 'experiments':
          showExperiments();
          break;
        case 'play':
          showPlayStat();
          break;
        case 'ads':
          showAdsStat();
          break;
        case 'exception':
          showException();
          break;
      }
    }

    function showLaunch() {
      fillChartDistribution('topTenChart',
        "http://simplestore.dipankar.co.in/api/analytics/distribution?ts_insert=@today&type=launch&_field=app_version&_strategy=chartjs"
      )
      buildTimeSeriesMulti('timelineChart', "http://simplestore.dipankar.co.in/api/analytics/ts_multi?type=launch", {
        "_payload": [{},
          {
            "app_id": "in.peerreview.fmradioindia"
          },
          {
            "app_id": "in.peerreview.radiohunt_tamil"
          },
          {
            "app_id": "in.peerreview.radiohunt_kannada"
          },
          {
            "app_id": "in.peerreview.radiohunt_telugu"
          },
          {
            "app_id": "in.peerreview.radiohunt_malayalam"
          },
          {
            "app_id": "in.peerreview.radiohunt_hindi"
          },
          {
            "app_id": "in.peerreview.radiohunt_marathi"
          },
          {
            "app_id": "in.peerreview.radiohunt_punjabi"
          },
          {
            "app_id": "in.peerreview.radiohunt_odia"
          },
        ]
      })
    }

    function showException() {
      fillChartDistribution('topTenChart',
        "http://simplestore.dipankar.co.in/api/analytics/distribution?ts_insert=@today&type=exception&_strategy=chartjs&_field=location"
      )
      buildTimeSeriesMulti('timelineChart', "http://simplestore.dipankar.co.in/api/analytics/ts_multi?type=exception", {
        "_payload": [{},
          {
            "app_id": "in.peerreview.fmradioindia"
          },
          {
            "app_id": "in.peerreview.radiohunt_tamil"
          },
          {
            "app_id": "in.peerreview.radiohunt_kannada"
          },
          {
            "app_id": "in.peerreview.radiohunt_telugu"
          },
          {
            "app_id": "in.peerreview.radiohunt_malayalam"
          },
          {
            "app_id": "in.peerreview.radiohunt_hindi"
          },
          {
            "app_id": "in.peerreview.radiohunt_marathi"
          },
          {
            "app_id": "in.peerreview.radiohunt_punjabi"
          },
          {
            "app_id": "in.peerreview.radiohunt_odia"
          },
        ]
      })
    }

    function showAdsStat() {
      fillChartDistribution('topTenChart',
        "http://simplestore.dipankar.co.in/api/analytics/distribution?ts_insert=@today&tag=regex:TELEMETRY_ADS_&_strategy=chartjs&_field=tag"
      )
      buildTimeSeriesMulti('timelineChart', "http://simplestore.dipankar.co.in/api/analytics/ts_multi", {
        "_payload": [{
            "tag": "TELEMETRY_ADS_LOAD"
          },
          {
            "tag": "TELEMETRY_ADS_REQUEST"
          },
          {
            "tag": "TELEMETRY_ADS_LOAD_ERROR"
          },
          {
            "tag": "TELEMETRY_ISTL_ADS_REQUEST"
          }
        ]
      })
    }

    function showExperiments() {
      fillChartDistribution('topTenChart',
        "http://simplestore.dipankar.co.in/api/analytics/distribution?ts_insert=@today&tag=regex:TELEMETRY_ADS_&_strategy=chartjs&_field=tag"
      )
      buildTimeSeriesMulti('timelineChart', "http://simplestore.dipankar.co.in/api/analytics/ts_multi", {
        "_payload": [{
            "tag": "TELEMETRY_CLICK_SIMILAR_ITEM"
          },
          {
            "tag": "TELEMETRY_DIALOG_SHARE"
          },
          {
            "tag": "TELEMETRY_DIALOG_RATING"
          }
        ]
      })
    }


    function showPlayStat() {
      fillChartDistribution('topTenChart',
        "http://simplestore.dipankar.co.in/api/analytics/distribution?ts_insert=@today&tag=regex:TELEMETRY_PLAYER_&_strategy=chartjs&_field=tag"
      )
      buildTimeSeriesMulti('timelineChart',
        "http://simplestore.dipankar.co.in/api/analytics/ts_multi?tag=TELEMETRY_PLAYER_ERROR", {
          "_payload": [{},
            {
              "app_id": "in.peerreview.fmradioindia"
            },
            {
              "app_id": "in.peerreview.radiohunt_tamil"
            },
            {
              "app_id": "in.peerreview.radiohunt_kannada"
            },
            {
              "app_id": "in.peerreview.radiohunt_telugu"
            },
            {
              "app_id": "in.peerreview.radiohunt_malayalam"
            },
            {
              "app_id": "in.peerreview.radiohunt_hindi"
            },
            {
              "app_id": "in.peerreview.radiohunt_marathi"
            },
            {
              "app_id": "in.peerreview.radiohunt_punjabi"
            },
            {
              "app_id": "in.peerreview.radiohunt_odia"
            },
          ]
        })
    }
    showTabs('launch');
  </script>
</head>
<style>
  body {
    background-color: #E9E9E9;
  }

  canvas {
    width: 1000px !important;
    height: 300px !important;
  }

  .nav {
    width: 150px;
    padding: 10px;
    line-height: 2;
    background: rgba(0, 0, 0, .9);
    color: white;
  }

  #kpi {
    background: white;
    border-radius: 5px;
    margin: 20px;
    height: 320px;
    padding: 10px;
    width: calc(100% - 40px);
    overflow: scroll;
    position: relative;
    border: 1px solid #BFBFBF;
    background-color: white;
    box-shadow: 5px 5px 2px #cccccc;
  }

  .pieLegend li span {
    display: inline-block;
    width: 12px;
    height: 12px;
    margin-right: 5px;
  }

  .pieLegend {
    display: inline-block;
    float: right;
    position: absolute;
    top: 0;
  }

  #container {
    display: inline-block;
    float: left;
    height: 50%;
    width: 70%;
  }

  .pieLegend>ul {
    list-style: none;
  }

  .hide {
    display: none !important;
  }

  .itemBox {
    width: 200px;
    height: 100px;
    background: white;
    text-align: center;
    padding: 20px;
    border-radius: 5px;
    background: #226e2e;
    color: white;
    margin: 20px;
  }
</style>

<body class="theme-light">
  <div class="flex_col" style="width: 100%;height: 100%;">
    <div class="flex_row" style="justify-content: flex-start;">
      <div class="flex_col nav">
        <p onclick="showTabs('launch')">Launch State</p>
        <p onclick="showTabs('plat')">Play State </p>
        <p onclick="showTabs('exception')">Exception State</p>
        <p onclick="showTabs('ads')">Ads State</p>
        <p onclick="showTabs('experiments')">Experiments</p>
        <p onclick=""><a
            href="http://simplestore.dipankar.co.in/api/analytics/delete?ts_insert=@3DaysOld&_confirmstr=analytics"
            target="_blanck">Clear Older Logs</a></p>
      </div>
      <div class="flex_col" style="width: 100%;">
        <div id="kpi_head" class="tab_content">
          <!-- launch-->
          <div class="launch">
            <div class="itemBox">
              <p class="textBold text_l"
                remote_url="http://simplestore.dipankar.co.in/api/analytics/count?ts_insert=@today&type=launch">
                ...</p>
              <p class="text_s">App Launch (<a target="_blank"
                  href="http://simplestore.dipankar.co.in/api/analytics/distribution?ts_insert=@today&type=launch&_field=app_version">more</a>)
              </p>
            </div>
          </div>

          <!-- play-->
          <div class="play">
            <div class="itemBox">
              <p class="textBold text_l"
                remote_url="http://simplestore.dipankar.co.in/api/analytics/count/?ts_insert=@today&tag=TELEMETRY_PLAYER_ERROR">
                ...</p>
              <p class="text_s">Play Error(<a target="_blank"
                  href="http://simplestore.dipankar.co.in/api/analytics/distribution/?ts_insert=@today&tag=TELEMETRY_PLAYER_ERROR&_field=url">more</a>)
              </p>
            </div>
          </div>

          <!-- Exception -->
          <div class="exception">
            <div class="itemBox">
              <p class="textBold text_l"
                remote_url="http://simplestore.dipankar.co.in/api/analytics/count?ts_insert=@today&type=exception">
                ...</p>
              <p class="text_s">Exception <a target="_blank"
                  href="http://simplestore.dipankar.co.in/api/analytics/distribution?ts_insert=@today&type=exception&_field=location">(more)</a>
              </p>
            </div>
          </div>

          <!-- ads-->
          <div class="ads">
            <div class="itemBox">
              <p class="textBold text_l"
                remote_url="http://simplestore.dipankar.co.in/api/analytics/count?ts_insert=@today&tag=TELEMETRY_ADS_LOAD_ERROR&_field=errorCode">
                ...</p>
              <p class="text_s">errorCode <a target="_blank"
                  href="http://simplestore.dipankar.co.in/api/analytics/distribution??ts_insert=@today&tag=TELEMETRY_ADS_LOAD_ERROR&_field=errorCode">(more)</a>
              </p>
            </div>
          </div>

          <!-- experiments -->
          <div class="experiments">
            <div class="itemBox">
              <p class="textBold text_l"
                remote_url="http://simplestore.dipankar.co.in/api/analytics/count?ts_insert=@today&type=exception">
                ...</p>
              <p class="text_s">Exception <a target="_blank"
                  href="http://simplestore.dipankar.co.in/api/analytics/distribution?ts_insert=@today&type=exception&_field=location">(more)</a>
              </p>
            </div>
          </div>
        </div>

        <!-- Chart 1 -->
        <div id="kpi">
          <div id="container">
            <canvas id="topTenChart"></canvas>
          </div>
          <div id="topTenLegend" class="pieLegend"></div>
        </div>
        <!-- charts 2 -->
        <div id="kpi">
          <div id="container">
            <canvas id="timelineChart"></canvas>
          </div>
          <div id="timelineLegend" class="pieLegend"></div>
        </div>
      </div>
    </div>
  </div>
</body>
<script>
  showTabs('launch')
</script>

</html>