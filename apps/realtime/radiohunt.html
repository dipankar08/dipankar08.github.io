<html>

<head>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script src="https://www.chartjs.org/dist/2.8.0/Chart.min.js"></script>


  <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/dipankar08/SimpleStyle/simplestyle.css" />
  <script src="https://cdn.jsdelivr.net/gh/dipankar08/SimpleStyle/simplestore_client.js"></script>


  <link rel="stylesheet" type="text/css" href="mystyle.css" />
  <script src="simplestore_client.js"></script>
  <script>
    var app_id_list = [
      {
        "app_id": "in.peerreview.fmradioindia"
      },
      {
        "app_id": "in.peerreview.radiohunt_tamil"
      },
      {
        "app_id": "in.peerreview.radiohunt_kannada"
      },
      {
        "app_id": "in.peerreview.radiohunt_telugu"
      },
      {
        "app_id": "in.peerreview.radiohunt_malayalam"
      },
      {
        "app_id": "in.peerreview.radiohunt_hindi"
      },
      {
        "app_id": "in.peerreview.radiohunt_marathi"
      },
      {
        "app_id": "in.peerreview.radiohunt_punjabi"
      },
      {
        "app_id": "in.peerreview.radiohunt_odia"
      },
      {
        "app_id": "in.peerreview.khabar"
      },
    ]

    function showTabs(tab) {
      $('.tab_content > div').addClass('hide');
      $('.' + tab).removeClass('hide');
      switch (tab) {
        case 'launch':
          showLaunch();
          break;
        case 'experiments':
          showExperiments();
          break;
        case 'play':
          showPlayStat();
          break;
        case 'ads':
          showAdsStat();
          break;
        case 'exception':
          showException();
          break;
        case 'khabar':
          showKhabar();
          break;
        case 'khabarapp':
          showKhabarApp();
          break;
      }
    }

    function showLaunch() {
      populateCount(".launch_1", "http://simplestore.dipankar.co.in/api/analytics/count?&type=launch", "http://simplestore.dipankar.co.in/api/analytics/distribution?ts_insert=@today&type=launch&_field=app_version", "Launch")

      populateDistribution("Launch #", 'topTenChart',
        "http://simplestore.dipankar.co.in/api/analytics/distribution?ts_insert=@today&type=launch&_field=app_version&_strategy=chartjs"
      )
      populateTimeSeries("Launch #", 'timelineChart', "http://simplestore.dipankar.co.in/api/analytics/ts_multi?type=launch", {
        "_payload": app_id_list
      })
    }
    function showKhabarApp() {
      populateCount(".khabarapp_1", "http://simplestore.dipankar.co.in/api/analytics/count?app_id=in.peerreview.khabar&tag=TELEMETRY_ADS_REQUEST", "http://simplestore.dipankar.co.in/api/analytics/distribution?app_id=in.peerreview.khabar&_field=tag", "TELEMETRY_ADS_REQUEST")
      populateCount(".khabarapp_2", "http://simplestore.dipankar.co.in/api/analytics/count?app_id=in.peerreview.khabar&tag=TELEMETRY_ADS_LOAD", "http://simplestore.dipankar.co.in/api/analytics/distribution?app_id=in.peerreview.khabar&_field=tag", "TELEMETRY_ADS_LOAD")
      populateCount(".khabarapp_3", "http://simplestore.dipankar.co.in/api/analytics/count?app_id=in.peerreview.khabar&type=exception", "http://simplestore.dipankar.co.in/api/analytics/distribution?app_id=in.peerreview.khabar&type=exception&_field=location", "exception")
      populateCount(".khabarapp_4", "http://simplestore.dipankar.co.in/api/analytics/count?app_id=in.peerreview.khabar&type=launch", "http://simplestore.dipankar.co.in/api/analytics/distribution?app_id=in.peerreview.khabar&type=launch&_field=app_version", "launch")
      populateCount(".khabarapp_5", "http://simplestore.dipankar.co.in/api/analytics/count?app_id=in.peerreview.khabar&block=APP_PANE_OPENED_DETAILS", "http://simplestore.dipankar.co.in/api/analytics/distribution?app_id=in.peerreview.khabar&type=launch&_field=app_version", "open story")
      populateCount(".khabarapp_6", "http://simplestore.dipankar.co.in/api/analytics/count?app_id=in.peerreview.khabar&block=APP_PANE_OPENED_LIST", "http://simplestore.dipankar.co.in/api/analytics/distribution?app_id=in.peerreview.khabar&type=launch&_field=app_version", "list opened")
      populateCount(".khabarapp_7", "http://simplestore.dipankar.co.in/api/analytics/count?app_id=in.peerreview.khabar&block=APP_PANE_OPENED_YOUTUBE", "http://simplestore.dipankar.co.in/api/analytics/distribution?app_id=in.peerreview.khabar&type=launch&_field=app_version", "open youtube")


      populateDistribution("Location #", 'topTenChart',
        "http://simplestore.dipankar.co.in/api/analytics/distribution?app_id=in.peerreview.khabar&_field=tag&ts_insert=@today&_strategy=chartjs"
      )
      populateTimeSeries("Tag Hits", 'timelineChart', "http://simplestore.dipankar.co.in/api/analytics/ts_multi?app_id=in.peerreview.khabar&_strategy=chartjs", { "_payload": [{ "type": "launch" }, { "type": "exception" }, { "block": "APP_PANE_OPENED_DETAILS" }] })
    }


    function showKhabar() {
      populateCount(".khabar_1", "http://simplestore.dipankar.co.in/api/khabar/count?", "http://simplestore.dipankar.co.in/api/khabar/distribution?_field=hostname&ts_insert=@today", "Insert Count")
      populateCount(".khabar_2", "http://simplestore.dipankar.co.in/api/analytics/count?app_id=khabar&tag=corn_job_executed", "http://simplestore.dipankar.co.in/api/analytics/distribution?app_id=khabar&_field=for&tag=corn_job_executed", "Cron Execution")
      populateCount(".khabar_3", "http://simplestore.dipankar.co.in/api/analytics/count?app_id=khabar&tag=invalid_list_selector", "http://simplestore.dipankar.co.in/api/analytics/distribution?app_id=khabar&_field=url:&tag=invalid_list_selector", "Invalid URL")
      populateCount(".khabar_4", "http://simplestore.dipankar.co.in/api/analytics/count?app_id=khabar&type=exception", "http://simplestore.dipankar.co.in/api/analytics/distribution?app_id=khabar&_field=location&type=exception&ts_insert=@today", "Exceptions")


      populateDistribution("Location #", 'topTenChart',
        "http://simplestore.dipankar.co.in/api/analytics/distribution?app_id=khabar&_field=tag&ts_insert=@today&_strategy=chartjs"
      )
      populateTimeSeries("Tag Hits ", 'timelineChart', "http://simplestore.dipankar.co.in/api/khabar/ts_multi", { "_payload": [{ "link_type": "http" }, { "link_type": "youtube" }] })
    }

    function showException() {
      populateCount(".exception_1", "http://simplestore.dipankar.co.in/api/analytics/count?type=exception", "http://simplestore.dipankar.co.in/api/analytics/distribution?ts_insert=@today&type=exception&_field=location"
      )

      populateDistribution("Location #", 'topTenChart',
        "http://simplestore.dipankar.co.in/api/analytics/distribution?ts_insert=@today&type=exception&_strategy=chartjs&_field=location"
      )
      populateTimeSeries("Exception Count", 'timelineChart', "http://simplestore.dipankar.co.in/api/analytics/ts_multi?type=exception", {
        "_payload": app_id_list
      })
    }

    function showAdsStat() {
      populateCount(".adds_1",
        "http://simplestore.dipankar.co.in/api/analytics/count?tag=TELEMETRY_ADS_LOAD_ERROR&_field=errorCode", "http://simplestore.dipankar.co.in/api/analytics/distribution?ts_insert=@today&tag=TELEMETRY_ADS_LOAD_ERROR&_field=errorCode"
      )
      populateCount(".adds_2",
        "http://simplestore.dipankar.co.in/api/analytics/count?tag=TELEMETRY_ADS_LOAD&_field=errorCode", "http://simplestore.dipankar.co.in/api/analytics/distribution?ts_insert=@today&tag=TELEMETRY_ADS_LOAD_ERROR&_field=errorCode"
      )

      populateDistribution("ads loads success #", 'topTenChart',
        "http://simplestore.dipankar.co.in/api/analytics/distribution?ts_insert=@today&tag=regex:TELEMETRY_ADS_LOAD&_strategy=chartjs&_field=tag"
      )
      populateTimeSeries("ads loads success #", 'timelineChart', "http://simplestore.dipankar.co.in/api/analytics/ts_multi?tag=regex:TELEMETRY_ADS_LOAD", {
        "_payload": app_id_list
      })
    }

    function showExperiments() {
      populateCount(".experiments_1", "http://simplestore.dipankar.co.in/api/analytics/count?&type=exception", "http://simplestore.dipankar.co.in/api/analytics/distribution?ts_insert=@today&type=exception&_field=location"
      )

      populateDistribution('topTenChart',
        "http://simplestore.dipankar.co.in/api/analytics/distribution?ts_insert=@today&tag=regex:TELEMETRY_ADS_&_strategy=chartjs&_field=tag"
      )
      populateTimeSeries('timelineChart', "http://simplestore.dipankar.co.in/api/analytics/ts_multi", {
        "_payload": app_id_list
      })
    }


    function showPlayStat() {
      populateCount(".play_1", "http://simplestore.dipankar.co.in/api/analytics/count?tag=TELEMETRY_PLAYER_ERROR", "http://simplestore.dipankar.co.in/api/analytics/distribution?ts_insert=@today&tag=TELEMETRY_PLAYER_ERROR&_field=url"
      )
      populateCount(".play_2", "http://simplestore.dipankar.co.in/api/analytics/count?tag=TELEMETRY_PLAYER_SUCCESS", "http://simplestore.dipankar.co.in/api/analytics/distribution?ts_insert=@today&tag=TELEMETRY_PLAYER_ERROR&_field=url"
      )
      populateDistribution("Player try/Success/error #", 'topTenChart',
        "http://simplestore.dipankar.co.in/api/analytics/distribution?ts_insert=@today&tag=regex:TELEMETRY_PLAYER_&_strategy=chartjs&_field=tag"
      )
      populateTimeSeries("Player Error #", 'timelineChart',
        "http://simplestore.dipankar.co.in/api/analytics/ts_multi?tag=TELEMETRY_PLAYER_ERROR", {
        "_payload": app_id_list
      })
    }
  </script>
</head>
<style>
  body {
    background-color: #E9E9E9;
  }

  canvas {
    width: 1000px !important;
    height: 300px !important;
  }

  .nav {
    width: 150px;
    padding: 10px;
    line-height: 2;
    background: rgba(0, 0, 0, .9);
    color: white;
  }

  .nav>p {
    cursor: pointer
  }

  .flex {
    display: flex;
    flex-wrap: wrap;
  }

  #kpi {
    background: white;
    border-radius: 5px;
    margin: 20px;
    height: 320px;
    padding: 10px;
    width: calc(100% - 40px);
    overflow: scroll;
    position: relative;
    border: 1px solid #BFBFBF;
    background-color: white;
    box-shadow: 5px 5px 2px #cccccc;
  }

  .pieLegend li span {
    display: inline-block;
    width: 12px;
    height: 12px;
    margin-right: 5px;
  }

  .pieLegend {
    display: inline-block;
    float: right;
    position: absolute;
    top: 0;
  }

  #container {
    display: inline-block;
    float: left;
    height: 50%;
    width: 70%;
  }

  .pieLegend>ul {
    list-style: none;
  }

  .hide {
    display: none !important;
  }

  .itemBox {
    background: white;
    text-align: center;
    padding: 20px;
    border-radius: 5px;
    background: #226e2e;
    color: white;
    margin: 20px;
  }
</style>

<body class="theme-light">
  <div class="flex_col" style="width: 100%;height: 100%;">
    <div class="flex_row" style="justify-content: flex-start;">
      <div class="flex_col nav">
        <p onclick="showTabs('launch')">Launch</p>
        <p onclick="showTabs('play')">Play</p>
        <p onclick="showTabs('exception')">Exception</p>
        <p onclick="showTabs('ads')">AdNetWork</p>
        <p onclick="showTabs('experiments')">Experiments</p>
        <p onclick="showTabs('khabar')">Khabar Parser</p>
        <p onclick="showTabs('khabarapp')">Khabar App</p>
        <p onclick=""><a
            href="http://simplestore.dipankar.co.in/api/analytics/delete?ts_insert=@3DaysOld&_confirmstr=analytics"
            target="_blanck">Clear Older Logs</a></p>
      </div>
      <div class="flex_col" style="width: 100%;">
        <div id="kpi_head" class="tab_content">
          <!-- launch-->
          <div class="flex launch">
            <div class="itemBox launch_1"></div>
          </div>

          <!-- Exception -->
          <div class="flex exception">
            <div class="itemBox exception_1"></div>
          </div>

          <!-- Khabar -->
          <div class="flex khabar">
            <div class="itemBox khabar_1"></div>
            <div class="itemBox khabar_2"></div>
            <div class="itemBox khabar_3"></div>
            <div class="itemBox khabar_4"></div>
          </div>
          <!-- Khabar -->
          <div class="flex khabarapp">
            <div class="itemBox khabarapp_1"></div>
            <div class="itemBox khabarapp_2"></div>
            <div class="itemBox khabarapp_3"></div>
            <div class="itemBox khabarapp_4"></div>
            <div class="itemBox khabarapp_5"></div>
            <div class="itemBox khabarapp_6"></div>
            <div class="itemBox khabarapp_7"></div>
            <div class="itemBox khabarapp_8"></div>
          </div>

          <!-- ads-->
          <div class="flex ads">
            <div class="itemBox adds_1"></div>
            <div class="itemBox adds_2"></div>
          </div>

          <!-- experiments -->
          <div class="flex experiments">
            <div class="itemBox experiments_1"></div>
          </div>

          <!-- PlayStates-->
          <div class="flex play">
            <div class="itemBox play_1"></div>
            <div class="itemBox play_2"></div>
          </div>
        </div>

        <!-- Chart 1 -->
        <div id="kpi">
          <div id="container">
            <canvas id="topTenChart"></canvas>
          </div>
          <div id="topTenLegend" class="pieLegend"></div>
        </div>
        <!-- charts 2 -->
        <div id="kpi">
          <div id="container">
            <canvas id="timelineChart"></canvas>
          </div>
          <div id="timelineLegend" class="pieLegend"></div>
        </div>
      </div>
    </div>
  </div>
</body>
<script>
  //showTabs('launch')
</script>

</html>